"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[154],{154:(w,Z,c)=>{c.r(Z),c.d(Z,{CrearOportunidadPageModule:()=>S});var h=c(6814),m=c(95),l=c(9843),f=c(7564),p=c(5861),g=c(8915),v=c(4664),b=c(9397),x=c(6528),C=c(553),e=c(6689),O=c(7153),T=c(2425),P=c(2264),y=c(930),M=c(5368);function A(n,d){if(1&n&&e._UZ(0,"ion-img",25),2&n){const a=e.oxw();e.Q6J("src",a.logotipo)}}function J(n,d){1&n&&(e.TgZ(0,"h5",26)(1,"b"),e._uU(2,"Documentos Agregados"),e.qZA()())}function N(n,d){if(1&n){const a=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.TgZ(3,"p"),e._uU(4),e.qZA()(),e.TgZ(5,"ion-button",27),e.NdJ("click",function(){const t=e.CHM(a).index,r=e.oxw();return e.KtG(r.eliminarDocumentos(t))}),e._UZ(6,"ion-icon",28),e.qZA()()}if(2&n){const a=d.$implicit;e.xp6(2),e.hij(" ",a.texto," "),e.xp6(2),e.Oqu(a.descripcion)}}function I(n,d){if(1&n){const a=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-button",27),e.NdJ("click",function(){const t=e.CHM(a).index,r=e.oxw();return e.KtG(r.eliminar(t))}),e._UZ(4,"ion-icon",28),e.qZA()()}if(2&n){const a=d.$implicit;e.xp6(2),e.Oqu(a)}}function k(n,d){if(1&n){const a=e.EpF();e.TgZ(0,"ion-button",29),e.NdJ("click",function(){e.CHM(a);const i=e.oxw();return e.KtG(i.download(i.documentoOpcional))}),e._UZ(1,"ion-icon",30),e.qZA()}}function U(n,d){if(1&n){const a=e.EpF();e.TgZ(0,"ion-button",31),e.NdJ("click",function(){e.CHM(a);const i=e.oxw();return e.KtG(i.click())}),e.TgZ(1,"ion-label"),e._uU(2,"Seleccionar archivo"),e.qZA(),e.TgZ(3,"input",32),e.NdJ("change",function(i){e.CHM(a);const t=e.oxw();return e.KtG(t.onFileSelected(i))}),e.qZA()()}}function F(n,d){if(1&n){const a=e.EpF();e.TgZ(0,"ion-button",33),e.NdJ("click",function(){e.CHM(a);const i=e.oxw();return e.KtG(i.click())}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"input",32),e.NdJ("change",function(i){e.CHM(a);const t=e.oxw();return e.KtG(t.onFileSelected(i))}),e.qZA()()}if(2&n){const a=e.oxw();e.Q6J("color",a.documentoOpcional?"success":"primary"),e.xp6(2),e.Oqu(a.documentoOpcional?"Archivo Cargado":"Seleccionar archivo")}}const D=[{path:"",component:(()=>{var n;class d{constructor(o,i,t,r,s,u,_,Y){this.loading=o,this.toast=i,this.compressImage=t,this.genericService=r,this.active=s,this.negocio=u,this.nav=_,this.modalC=Y,this.empresa="",this.toolbar=[[{heading:["h1","h2","h3","h4","h5","h6"]}],["bold","italic"],["underline","strike"],["ordered_list","bullet_list"],["align_left","align_center","align_right","align_justify"],["horizontal_rule","format_clear"],["text_color","background_color"]],this.edit=!1,this.documentos=[],this.especialidades=[],this.uri=C.N.image+"oportunidades-logotipos/",this.uriDoc=C.N.image+"oportunidades-documentoInformativo/",this.especialidad="",this.document={texto:"",descripcion:""},this.convocatoria=""}ngOnInit(){this.editor=new g.ML,this.active.params.pipe((0,v.w)(o=>(o.identificador&&(this.edit=!0,this.identificador=o.identificador),this.negocio.negocio$))).subscribe(o=>{if(this.edit){const i=o.find(t=>t.id===Number(this.identificador));i?(this.documentos=i.documentos,this.especialidades=i.especialidades,this.empresa=i.empresa,this.logotipo=i.logotipo?this.uri+i.logotipo:null,this.documentoOpcional=i.documento?this.uriDoc+i.documento:null,this.convocatoria=i.convocatoria):this.nav.navigateForward("/dashboard/negocios")}})}uploadImage(){var o=this;return(0,p.Z)(function*(){o.logotipo=yield o.compressImage.returnImageCompress();const i=yield o.modalC.create({component:x.n,animated:!0,componentProps:{imageUrl:o.logotipo}});i.onDidDismiss().then(({data:t})=>{o.logotipo=null!=t?t:null}),yield i.present()})()}agregarEspecialidad(){this.especialidades.push(this.especialidad),this.especialidad=""}eliminar(o){this.especialidades.splice(o,1)}agregarDocumentos(){this.documentos.push(this.document),this.document={texto:"",descripcion:""}}eliminarDocumentos(o){this.documentos.splice(o,1)}save(){var o=this;return(0,p.Z)(function*(){if(o.edit)return void(yield o.editNegocio());o.loading.setData({animated:!0,message:"Subiendo...",spinner:"dots"}),yield o.loading.create(),yield o.loading.show();const i=new FormData;i.append("logotipo",o.compressImage.dataURItoBlob(o.logotipo)),o.genericService.post("negocio",i).pipe((0,v.w)(function(){var t=(0,p.Z)(function*(r){let s;if(s="string"!=typeof o.convocatoria?(0,g.io)(o.convocatoria):o.convocatoria,o.documentoOpcional){const u=new FormData;u.append("documento",o.documentoOpcional),yield o.genericService.updateWhitImage("negocio",r.id,u).toPromise()}return o.genericService.update("negocio",r.id,{especialidades:o.especialidades,documentos:o.documentos,empresa:o.empresa,convocatoria:s}).toPromise()});return function(r){return t.apply(this,arguments)}}()),(0,b.b)(function(){var t=(0,p.Z)(function*(r){o.empresa="",o.logotipo=null,o.especialidad="",o.especialidades=[],o.documentos=[],o.document={texto:"",descripcion:""},o.convocatoria="",o.documentoOpcional=null,yield o.loading.hide(),o.toast.success("Nueva Oportunidad de Negocio","Creada")});return function(r){return t.apply(this,arguments)}}())).subscribe()})()}onFileSelected(o){this.documentoOpcional=o.target.files[0],o.target.value=""}click(){document.getElementById("opcional").click()}editNegocio(){var o=this;return(0,p.Z)(function*(){var i;o.loading.setData({animated:!0,message:"Actualizando...",spinner:"dots"}),yield o.loading.create(),yield o.loading.show();const t=new FormData;o.logotipo&&!(null!==(i=o.logotipo)&&void 0!==i&&i.includes(o.uri))&&t.append("logotipo",o.compressImage.dataURItoBlob(o.logotipo)),o.genericService.update("negocio",Number(o.identificador),t).pipe((0,v.w)(function(){var r=(0,p.Z)(function*(s){let u;if(u="string"!=typeof o.convocatoria?(0,g.io)(o.convocatoria):o.convocatoria,o.documentoOpcional&&"string"!=typeof o.documentoOpcional){const _=new FormData;_.append("documento",o.documentoOpcional),yield o.genericService.updateWhitImage("negocio",s.id,_).toPromise()}return o.genericService.update("negocio",s.id,{especialidades:o.especialidades,documentos:o.documentos,empresa:o.empresa,convocatoria:u}).toPromise()});return function(s){return r.apply(this,arguments)}}()),(0,b.b)(function(){var r=(0,p.Z)(function*(s){o.empresa="",o.logotipo=null,o.especialidad="",o.especialidades=[],o.documentos=[],o.document={texto:"",descripcion:""},o.convocatoria="",o.documentoOpcional=null,yield o.loading.hide(),o.toast.success("Oportunidad de Negocio","Actualizada"),o.negocio.updateNegocio(s.id,s),o.nav.navigateForward("/dashboard/negocios")});return function(s){return r.apply(this,arguments)}}())).subscribe()})()}download(o){const i=document.createElement("a");i.href=o,i.download=o,document.body.appendChild(i),i.click(),document.body.removeChild(i)}valid(){var o;return"string"==typeof this.documentoOpcional&&this.edit&&(null===(o=this.documentoOpcional)||void 0===o?void 0:o.includes(this.uriDoc))}}return(n=d).\u0275fac=function(o){return new(o||n)(e.Y36(O.b),e.Y36(T._W),e.Y36(P.Y),e.Y36(y.M),e.Y36(f.gz),e.Y36(M.v),e.Y36(l.SH),e.Y36(l.IN))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-crear-oportunidad"]],decls:55,vars:22,consts:[[3,"fullscreen"],["color","dark",1,"py-2"],[1,"ms-2","ms-md-5","mb-0","titulo"],[1,"palito","ms-2","ms-md-5","mt-0","mb-3"],[1,"mt-1","px-3"],[1,"container"],["button","",3,"click"],["style","max-width: 200px; max-height: 330px;",3,"src",4,"ngIf"],["type","text","labelPlacement","floating","label","Nombre de la empresa",3,"ngModel","ngModelChange"],[1,"my-3"],["type","text","labelPlacement","floating","label","Ingrese Nombre del Documento",3,"ngModel","ngModelChange"],["slot","end",3,"disabled","click"],["slot","icon-only","name","add"],["labelPlacement","floating","label","Ingrese Descripci\xf3n",3,"ngModel","ngModelChange"],["class","my-2",4,"ngIf"],[4,"ngFor","ngForOf"],["type","text","labelPlacement","floating","label","Ingrese Especialidad",3,"ngModel","ngModelChange"],[1,"NgxEditor__Wrapper"],[3,"toolbar","editor"],[3,"editor","ngModel","placeholder","ngModelChange"],["color","danger"],["slot","start","fill","clear",3,"click",4,"ngIf"],["expand","block","fill","clear","slot","end",3,"click",4,"ngIf"],["expand","block","fill","clear","slot","end",3,"color","click",4,"ngIf"],["expand","block","shape","round",1,"my-3",3,"disabled","click"],[2,"max-width","200px","max-height","330px",3,"src"],[1,"my-2"],["slot","end",3,"click"],["slot","icon-only","name","close"],["slot","start","fill","clear",3,"click"],["slot","icon-only","name","download-outline"],["expand","block","fill","clear","slot","end",3,"click"],["id","opcional","type","file","accept",".pdf",2,"display","none",3,"change"],["expand","block","fill","clear","slot","end",3,"color","click"]],template:function(o,i){1&o&&(e.TgZ(0,"ion-content",0),e._UZ(1,"br"),e.TgZ(2,"ion-toolbar",1),e._UZ(3,"br"),e.TgZ(4,"h1",2)(5,"b"),e._uU(6),e.qZA()(),e._UZ(7,"hr",3),e.qZA(),e.TgZ(8,"div",4)(9,"div",5)(10,"div",5)(11,"ion-item",6),e.NdJ("click",function(){return i.uploadImage()}),e.TgZ(12,"ion-label"),e._uU(13,"Subir Imagen"),e.qZA(),e.YNc(14,A,1,1,"ion-img",7),e.qZA(),e.TgZ(15,"ion-item")(16,"ion-input",8),e.NdJ("ngModelChange",function(r){return i.empresa=r}),e.qZA()(),e.TgZ(17,"h3",9)(18,"b"),e._uU(19,"Agregar Documentos"),e.qZA()(),e.TgZ(20,"ion-item")(21,"ion-input",10),e.NdJ("ngModelChange",function(r){return i.document.texto=r}),e.qZA(),e.TgZ(22,"ion-button",11),e.NdJ("click",function(){return i.agregarDocumentos()}),e._UZ(23,"ion-icon",12),e.qZA()(),e.TgZ(24,"ion-item")(25,"ion-textarea",13),e.NdJ("ngModelChange",function(r){return i.document.descripcion=r}),e.qZA()(),e.YNc(26,J,3,0,"h5",14),e.YNc(27,N,7,2,"ion-item",15),e.TgZ(28,"h3",9)(29,"b"),e._uU(30,"Agregar Especialidades"),e.qZA()(),e.TgZ(31,"ion-item")(32,"ion-input",16),e.NdJ("ngModelChange",function(r){return i.especialidad=r}),e.qZA(),e.TgZ(33,"ion-button",11),e.NdJ("click",function(){return i.agregarEspecialidad()}),e._UZ(34,"ion-icon",12),e.qZA()(),e.YNc(35,I,5,1,"ion-item",15),e.qZA()(),e.TgZ(36,"div",5)(37,"h3",9)(38,"b"),e._uU(39,"Informaci\xf3n Adicional "),e.qZA()(),e.TgZ(40,"div",17),e._UZ(41,"ngx-editor-menu",18),e.TgZ(42,"ngx-editor",19),e.NdJ("ngModelChange",function(r){return i.convocatoria=r}),e.qZA()(),e.TgZ(43,"ion-item")(44,"ion-label"),e._uU(45," PDF con informaci\xf3n adicional"),e.TgZ(46,"ion-text",20),e._uU(47," * "),e.qZA(),e.TgZ(48,"p"),e._uU(49,"(formato PDF)"),e.qZA()(),e.YNc(50,k,2,0,"ion-button",21),e.YNc(51,U,4,0,"ion-button",22),e.YNc(52,F,4,2,"ion-button",23),e.qZA(),e.TgZ(53,"ion-button",24),e.NdJ("click",function(){return i.save()}),e._uU(54),e.qZA()()()()),2&o&&(e.Q6J("fullscreen",!0),e.xp6(6),e.hij(" ",i.edit?"Editar":"Crear"," Oportunidades de Negocio"),e.xp6(8),e.Q6J("ngIf",i.logotipo),e.xp6(2),e.Q6J("ngModel",i.empresa),e.xp6(5),e.Q6J("ngModel",i.document.texto),e.xp6(1),e.Q6J("disabled",""===i.document.texto),e.xp6(3),e.Q6J("ngModel",i.document.descripcion),e.xp6(1),e.Q6J("ngIf",i.documentos.length>0),e.xp6(1),e.Q6J("ngForOf",i.documentos),e.xp6(5),e.Q6J("ngModel",i.especialidad),e.xp6(1),e.Q6J("disabled",!i.especialidad||""===i.especialidad),e.xp6(2),e.Q6J("ngForOf",i.especialidades),e.xp6(6),e.Q6J("toolbar",i.toolbar)("editor",i.editor),e.xp6(1),e.Q6J("editor",i.editor)("ngModel",i.convocatoria)("placeholder","Descripci\xf3n del evento"),e.xp6(8),e.Q6J("ngIf",i.valid()),e.xp6(1),e.Q6J("ngIf",i.edit),e.xp6(1),e.Q6J("ngIf",!i.edit),e.xp6(1),e.Q6J("disabled",!i.logotipo||""===i.empresa),e.xp6(1),e.hij(" ",i.edit?"Actualizar":"Crear"," "))},dependencies:[h.sg,h.O5,m.JJ,m.On,l.YG,l.W2,l.gu,l.Xz,l.pK,l.Ie,l.Q$,l.yW,l.g2,l.sr,l.j9,g.tP,g.Mn]}),d})()}];let Q=(()=>{var n;class d{}return(n=d).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[f.Bz.forChild(D),f.Bz]}),d})(),S=(()=>{var n;class d{}return(n=d).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,m.u5,m.UX,l.Pc,g.FP,Q]}),d})()}}]);