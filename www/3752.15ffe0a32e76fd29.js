"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3752],{3752:(vt,Y,c)=>{c.r(Y),c.d(Y,{VerEventoPageModule:()=>ut});var p=c(6814),h=c(95),m=c(9843),x=c(7564),u=c(5861),f=c(1486),G=c(6676),H=c(553),K=c(4028),t=c(6689),Q=c(8013),z=c(1284),L=c(4433),j=c(7153),B=c(2425),W=c(930),R=c(7602),X=c(6991);let $=(()=>{var s;class l{transform(n,e){const i=[];if(!e)return n;if(n)for(const r of n)(null==r?void 0:r.titulo.toLowerCase().indexOf(e.toLowerCase()))>-1&&i.push(r);return(0,X.o)(i)}}return(s=l).\u0275fac=function(n){return new(n||s)},s.\u0275pipe=t.Yjl({name:"eventoSearch",type:s,pure:!0}),l})();function tt(s,l){if(1&s){const a=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(a);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.cerrarEvento(e.id))}),t._UZ(1,"ion-icon",26),t.qZA()}}function et(s,l){if(1&s){const a=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(a);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.reactivar(e.id))}),t._UZ(1,"ion-icon",27),t.qZA()}}function nt(s,l){if(1&s){const a=t.EpF();t.TgZ(0,"tr")(1,"th",15),t._UZ(2,"ion-img",16),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td")(8,"ion-buttons",17)(9,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.vistaPrevia(i.id))}),t._UZ(10,"ion-icon",19),t.qZA(),t.TgZ(11,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.exportToExcel(i.id))}),t._UZ(12,"ion-icon",20),t.qZA(),t.TgZ(13,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.modalUser(i.id))}),t._UZ(14,"ion-icon",21),t.qZA(),t.TgZ(15,"ion-button",22),t._UZ(16,"ion-icon",23),t.qZA(),t.TgZ(17,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.deleteEvento(i.id))}),t._UZ(18,"ion-icon",24),t.qZA(),t.YNc(19,tt,2,0,"ion-button",25),t.YNc(20,et,2,0,"ion-button",25),t.qZA()()()}if(2&s){const a=l.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("src",n.uri+a.imagen),t.xp6(2),t.Oqu(a.titulo),t.xp6(2),t.Oqu(n.mon(a.fechaInicio)),t.xp6(9),t.MGl("routerLink","editar-evento/",a.id,""),t.xp6(4),t.Q6J("ngIf",a.active),t.xp6(1),t.Q6J("ngIf",!a.active)}}function ot(s,l){if(1&s&&(t.TgZ(0,"tbody"),t.YNc(1,nt,21,6,"tr",14),t.ALo(2,"eventoSearch"),t.qZA()),2&s){const a=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,a.eventos,a.search))}}function it(s,l){if(1&s){const a=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(a);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.cerrarEvento(e.id))}),t._UZ(1,"ion-icon",26),t.qZA()}}function rt(s,l){if(1&s){const a=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(a);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.reactivar(e.id))}),t._UZ(1,"ion-icon",27),t.qZA()}}function at(s,l){if(1&s){const a=t.EpF();t.TgZ(0,"tr")(1,"th",15),t._UZ(2,"ion-img",16),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td")(8,"ion-buttons",17)(9,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.vistaPrevia(i.id))}),t._UZ(10,"ion-icon",19),t.qZA(),t.TgZ(11,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.exportToExcel(i.id))}),t._UZ(12,"ion-icon",20),t.qZA(),t.TgZ(13,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.modalUser(i.id))}),t._UZ(14,"ion-icon",21),t.qZA(),t.TgZ(15,"ion-button",22),t._UZ(16,"ion-icon",23),t.qZA(),t.TgZ(17,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.deleteEvento(i.id))}),t._UZ(18,"ion-icon",24),t.qZA(),t.TgZ(19,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(a).$implicit,r=t.oxw(2);return t.KtG(r.duplicate(i))}),t._UZ(20,"ion-icon",28),t.qZA(),t.YNc(21,it,2,0,"ion-button",25),t.YNc(22,rt,2,0,"ion-button",25),t.qZA()()()}if(2&s){const a=l.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("src",n.uri+a.imagen),t.xp6(2),t.Oqu(a.titulo),t.xp6(2),t.Oqu(n.mon(a.fechaInicio)),t.xp6(9),t.MGl("routerLink","editar-evento/",a.id,""),t.xp6(6),t.Q6J("ngIf",a.active),t.xp6(1),t.Q6J("ngIf",!a.active)}}function st(s,l){if(1&s&&(t.TgZ(0,"tbody"),t.YNc(1,at,23,6,"tr",14),t.qZA()),2&s){const a=t.oxw();t.xp6(1),t.Q6J("ngForOf",a.eventosSelected)}}const ct=[{path:"",component:(()=>{var s;class l{constructor(n,e,i,r,d,v,_){this.eventoRepo=n,this.boletosRepo=e,this.nav=i,this.alert=r,this.loading=d,this.toast=v,this.genericService=_,this.uri=H.N.image+"eventos/",this.eventos=[],this.eventosSelected=[],this.divisor=10}ngOnInit(){this.eventoRepo.evento$.subscribe(n=>{this.eventos=n.sort((e,i)=>new Date(i.fechaInicio).getTime()-new Date(e.fechaInicio).getTime()),this.eventosSelected=n.slice(0,this.divisor)})}mon(n){return G(n).locale("es").format("L")+" "+G(new Date(n)).utc().format("LTS")}vistaPrevia(n){var e=this;return(0,u.Z)(function*(){const i=e.eventos.find(r=>r.id===n);i&&window.open(H.N.host+"evento/"+i.identificador,"_blank")})()}exportToExcel(n){const e=this.eventos.find(o=>o.id===n);let i=[];console.log(null==e?void 0:e.boletos);for(let o of null==e?void 0:e.boletos){var r,d,v,_,g,Z,y,E,T,C,P,b,A,V,U,J,N,M,w,F,S,k,q,I,D;i.push({Folio:o.folio,Nombre:o.afiliado?null==o||null===(r=o.afiliado)||void 0===r?void 0:r.nombre:null!==(d=null==o||null===(v=o.participante)||void 0===v?void 0:v.nombre)&&void 0!==d?d:"",Cargo:o.afiliado?null==o||null===(_=o.afiliado)||void 0===_?void 0:_.cargo:null!==(g=null==o||null===(Z=o.participante)||void 0===Z?void 0:Z.cargo)&&void 0!==g?g:"",Empresa:o.afiliado?null==o||null===(y=o.afiliado)||void 0===y?void 0:y.empresa:null!==(E=null==o||null===(T=o.participante)||void 0===T?void 0:T.empresa)&&void 0!==E?E:"",Organizaci\u00f3n:o.afiliado?null==o||null===(C=o.afiliado)||void 0===C?void 0:C.organizacion:null!==(P=null==o||null===(b=o.participante)||void 0===b?void 0:b.organizacion)&&void 0!==P?P:"",Correo:o.afiliado?null==o||null===(A=o.afiliado)||void 0===A?void 0:A.email:null!==(V=null==o||null===(U=o.participante)||void 0===U?void 0:U.email)&&void 0!==V?V:"",Tel\u00e9fono:o.afiliado?null==o||null===(J=o.afiliado)||void 0===J?void 0:J.telefono:null!==(N=null==o||null===(M=o.participante)||void 0===M?void 0:M.telefono)&&void 0!==N?N:"","Tipo Asistencia":null!==(w=o.privilegio)&&void 0!==w?w:"N/A","Forma de Pago":o.idPago?"Tarjeta de cr\xe9dito":"Transferencia","Boleto Pagado":o.active?"Si":"No","Necesita Factura":o.quieroFactura?"Si":"No",RFC:o.afiliado?null==o||null===(F=o.afiliado)||void 0===F?void 0:F.rfc:null!==(S=null==o||null===(k=o.participante)||void 0===k?void 0:k.rfc)&&void 0!==S?S:"",CURP:null!==(q=null==o||null===(I=o.participante)||void 0===I?void 0:I.curp)&&void 0!==q?q:"","Tipo de Registro":null!==(D=K.x[o.participante.tipo])&&void 0!==D?D:"N/A"})}if(i){const o=f.P6.json_to_sheet(i),O=f.P6.book_new();f.P6.book_append_sheet(O,o,"Sheet1"),f.NC(O,(null==e?void 0:e.titulo.toUpperCase())+".xlsx")}}modalUser(n){var e=this;return(0,u.Z)(function*(){const i=e.eventos.find(r=>r.id===n);i&&(e.boletosRepo.setEventos(i.boletos),e.nav.navigateForward("dashboard/eventos/ver-usuarios",{queryParams:{id:n}}))})()}deleteEvento(n){var e=this;return(0,u.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Est\xe1 a punto de eliminar este evento",message:"Si lo elimina se perder\xe1n todos los datos relacionados. \n \xbfDesea continuar?",buttons:[{text:"Cancelar"},{text:"Confirmar",handler:(i=(0,u.Z)(function*(){e.loading.setData({animated:!0,message:"Eliminando",spinner:"dots"}),yield e.loading.create(),yield e.loading.show(),e.genericService.delete("evento",n).subscribe(function(){var r=(0,u.Z)(function*(d){yield e.loading.hide(),e.toast.success("Evento Eliminado"),e.eventoRepo.deleteEvento(n)});return function(d){return r.apply(this,arguments)}}())}),function(){return i.apply(this,arguments)})}]})})()}cerrarEvento(n){var e=this;return(0,u.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Cerrar Evento",message:"Est\xe1 a punto de cerrar el evento una vez lo haga no podr\xe1 reabrilo \xbfDesea Continuar?",inputs:[{name:"titulo",type:"text",placeholder:"Ingrese Titulo"},{name:"descripcion",type:"textarea",placeholder:"Ingrese texto "}],buttons:[{text:"Cancelar"},{text:"Cerrar",handler:(i=(0,u.Z)(function*(r){yield e.loading.setData({animated:!0,message:"Cerrando Evento..."}),yield e.loading.create(),yield e.loading.show(),e.genericService.update("evento",n,{active:!1,modal:{titulo:r.titulo,descripcion:r.descripcion}}).subscribe(function(){var v=(0,u.Z)(function*(_){e.eventos=e.eventos.map(g=>g.id===n?_:g),yield e.loading.hide(),e.toast.success("Evento Cerrado","Correcto"),e.eventos=e.eventos.map(g=>g.id===n?{...g,active:!1}:g)});return function(_){return v.apply(this,arguments)}}())}),function(d){return i.apply(this,arguments)})}]})})()}reactivar(n){var e=this;return(0,u.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Reactivar Evento",message:"Est\xe1 a punto de reactivar el evento le recomendamos editar el evento antes de hacerlo \xbfDesea Continuar?",buttons:[{text:"Cancelar"},{text:"Reactivar",handler:(i=(0,u.Z)(function*(){yield e.loading.setData({animated:!0,message:"Cerrando Evento..."}),yield e.loading.create(),yield e.loading.show(),e.genericService.update("evento",n,{active:!0,modal:null}).subscribe(function(){var r=(0,u.Z)(function*(d){e.eventos=e.eventos.map(v=>v.id===n?d:v),yield e.loading.hide(),e.toast.success("Evento Reactivado","Correcto")});return function(d){return r.apply(this,arguments)}}())}),function(){return i.apply(this,arguments)})}]})})()}getPagina(n){this.eventosSelected=this.eventos.slice(n*this.divisor,(n+1)*this.divisor)}duplicate(n){var e=this;return(0,u.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Duplicar "+n.titulo,message:"Ingrese un titulo distinto para duplicar el evento",inputs:[{name:"titulo",type:"text",placeholder:"Ingresar aqu\xed"}],buttons:[{text:"Cancelar"},{text:"Duplicar",handler:(i=(0,u.Z)(function*({titulo:r}){r&&0!==r.length?(yield e.loading.setData({animated:!0,message:"Duplicando Evento..."}),yield e.loading.create(),yield e.loading.show(),n.titulo=r,e.genericService.post("evento/duplicate",{...n,boletos:[],id:void 0}).subscribe(function(){var d=(0,u.Z)(function*(v){e.eventos.push(v),e.eventos=e.eventos.sort((_,g)=>new Date(g.fechaInicio).getTime()-new Date(_.fechaInicio).getTime()),yield e.loading.hide(),e.toast.success("Evento duplicado","Correcto")});return function(v){return d.apply(this,arguments)}}())):e.duplicate(n)}),function(d){return i.apply(this,arguments)})}]})})()}}return(s=l).\u0275fac=function(n){return new(n||s)(t.Y36(Q.hJ),t.Y36(z.b9),t.Y36(m.SH),t.Y36(L.c),t.Y36(j.b),t.Y36(B._W),t.Y36(W.M))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-ver-evento"]],decls:27,vars:7,consts:[[3,"fullscreen"],["color","dark",1,"mt-4","py-2"],[1,"ms-2","ms-md-5","mb-0","titulo"],[1,"palito","ms-2","ms-md-5","mt-0","mb-3"],[1,"mt-2","px-3"],[1,"container"],[1,"d-flex","mt-1"],["placeholder","Buscar evento","inputmode","text","type","text",1,"ms-auto","me-3","my-0","w-100",3,"ngModel","debounce","ngModelChange"],[1,"table","mt-0"],[1,"red"],["scope","col",1,"red","d-none","d-md-block"],["scope","col",1,"red"],[4,"ngIf"],[3,"total","divisor","pagina"],[4,"ngFor","ngForOf"],["scope","row",1,"text-center","d-none","d-md-block"],[1,"img-fluid",3,"src"],["color","primary","slot","start"],["color","primary",3,"click"],["slot","icon-only","name","eye-outline"],["slot","icon-only","name","download-outline"],["slot","icon-only","name","people-outline"],["color","primary",3,"routerLink"],["slot","icon-only","name","create-outline"],["slot","icon-only","name","trash-outline"],["color","primary",3,"click",4,"ngIf"],["slot","icon-only","name","close-outline"],["slot","icon-only","name","power-outline"],["slot","icon-only","name","copy-outline"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-content",0)(1,"ion-toolbar",1),t._UZ(2,"br"),t.TgZ(3,"h1",2)(4,"b"),t._uU(5,"Eventos Registrados"),t.qZA()(),t._UZ(6,"hr",3),t.qZA(),t._UZ(7,"br")(8,"br"),t.TgZ(9,"div",4)(10,"div",5)(11,"div",6)(12,"ion-searchbar",7),t.NdJ("ngModelChange",function(){return e.eventosSelected=[]})("ngModelChange",function(r){return e.search=r}),t.qZA()(),t.TgZ(13,"table",8)(14,"thead",9)(15,"tr")(16,"th",10),t._uU(17,"Foto"),t.qZA(),t.TgZ(18,"th",11),t._uU(19,"Nombre"),t.qZA(),t.TgZ(20,"th",11),t._uU(21,"Dia y Hora"),t.qZA(),t.TgZ(22,"th",11),t._uU(23,"Opciones"),t.qZA()()(),t.YNc(24,ot,3,4,"tbody",12),t.YNc(25,st,2,1,"tbody",12),t.qZA()()(),t.TgZ(26,"paginador",13),t.NdJ("pagina",function(r){return e.getPagina(r)}),t.qZA()()),2&n&&(t.Q6J("fullscreen",!0),t.xp6(12),t.Q6J("ngModel",e.search)("debounce",250),t.xp6(12),t.Q6J("ngIf",0==e.eventosSelected.length),t.xp6(1),t.Q6J("ngIf",e.eventosSelected.length>0),t.xp6(1),t.Q6J("total",e.eventos.length)("divisor",e.divisor))},dependencies:[p.sg,p.O5,h.JJ,h.On,m.YG,m.Sm,m.W2,m.gu,m.Xz,m.VI,m.sr,m.j9,m.YI,x.rH,R.a,$],styles:[".red[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);color:#fff}.img-fluid[_ngcontent-%COMP%]{max-width:100px}"]}),l})()}];let lt=(()=>{var s;class l{}return(s=l).\u0275fac=function(n){return new(n||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[x.Bz.forChild(ct),x.Bz]}),l})();var dt=c(3386);let ut=(()=>{var s;class l{}return(s=l).\u0275fac=function(n){return new(n||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[p.ez,h.u5,m.Pc,lt,R.a,dt.d]}),l})()}}]);