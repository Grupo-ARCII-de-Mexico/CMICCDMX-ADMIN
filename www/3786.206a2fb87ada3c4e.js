"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3786],{3786:(A,f,r)=>{r.r(f),r.d(f,{BoletinesPageModule:()=>M});var v=r(6814),m=r(95),s=r(9843),p=r(7564),h=r(5861),u=r(8915),b=r(4664),F=r(553),e=r(6689),B=r(2264),x=r(4846),Z=r(2425),y=r(930),P=r(6533);function C(o,l){if(1&o){const d=e.EpF();e.TgZ(0,"ion-img",16),e.NdJ("click",function(){const n=e.CHM(d).$implicit,a=e.oxw();return e.KtG(a.eliminarimagenes(n))}),e.qZA()}2&o&&e.Q6J("src",l.$implicit)}const T=[{path:"",component:(()=>{var o;class l{constructor(i,t,n,a,c,g,N,U,Y){this.fb=i,this.compress=t,this.sliderRepo=n,this.toast=a,this.genericS=c,this.params=g,this.nav=N,this.authRepo=U,this.modalC=Y,this.toolbar=[["bold","italic"],["underline","strike"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}],["link","image"],["text_color","background_color"],["align_left","align_center","align_right","align_justify"]],this.editar=!1,this.uri=F.N.image+"boletines/",this.image=[]}ngOnInit(){var i=this;this.editor=new u.ML,this.authRepo.user$.subscribe(t=>this.name=t[0].names),this.sliderForm=this.fb.group({titulo:[null],informacion:[null],fecha:[null]}),this.params.params.pipe((0,b.w)(t=>{var n;return this.identificador=Number(null!==(n=null==t?void 0:t.identificador)&&void 0!==n?n:0),this.sliderRepo.boletin$})).subscribe(function(){var t=(0,h.Z)(function*(n){if(0!==i.identificador){const a=n.find(g=>g.id===i.identificador);i.sliderForm.setValue({titulo:a.titulo,informacion:a.informacion,fecha:a.fecha});let c=[];for(const g of a.imagenes)c.push(i.uri+g);i.image=c,0==c.length&&(i.image=[i.uri+a.imagen]),i.editar=!0}});return function(n){return t.apply(this,arguments)}}())}addImage(){var i=this;return(0,h.Z)(function*(){i.image=yield i.compress.returnImageCompressMultiple()})()}save(){var i=this;return(0,h.Z)(function*(){if(i.editar)return i.edit();const t=new FormData;if(i.image.length>0)for(const c of i.image)t.append("imagenes",i.compress.dataURItoBlob(c));let n;n="string"!=typeof i.sliderForm.controls.informacion.value?(0,u.io)(i.sliderForm.controls.informacion.value):i.sliderForm.controls.informacion.value,t.append("titulo",i.sliderForm.controls.titulo.value),t.append("autor",i.name),t.append("informacion",n);const a=i.sliderForm.controls.titulo.value.replace(/ /g,"-");t.append("identificador",a.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()),i.genericS.post("boletines",t).subscribe(c=>{i.toast.success("Bolet\xedn Creado"),i.sliderRepo.addBoletin(c),i.image=[],i.sliderForm.reset()})})()}edit(){const i=new FormData;if(this.image.length>0)for(const a of this.image)a.includes("data:")&&i.append("imagenes",this.compress.dataURItoBlob(this.image));let t;i.append("titulo",this.sliderForm.controls.titulo.value),i.append("autor",this.name),t="string"!=typeof this.sliderForm.controls.informacion.value?(0,u.io)(this.sliderForm.controls.informacion.value):this.sliderForm.controls.informacion.value;const n=this.sliderForm.controls.titulo.value.replace(/ /g,"-");i.append("identificador",n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()),i.append("informacion",t),this.genericS.updateWhitImage("boletines",this.identificador,i).subscribe(a=>{this.toast.success("Bolet\xedn Actualizado"),this.sliderRepo.updateBoletin(this.identificador,a),this.image=[],this.sliderForm.reset(),this.nav.navigateBack("/dashboard/website/boletines-ver")})}eliminarimagenes(i){const t=this.image.indexOf(i);-1!==t&&this.image.splice(t,1)}}return(o=l).\u0275fac=function(i){return new(i||o)(e.Y36(m.qu),e.Y36(B.Y),e.Y36(x.a),e.Y36(Z._W),e.Y36(y.M),e.Y36(p.gz),e.Y36(s.SH),e.Y36(P.O),e.Y36(s.IN))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-boletines"]],decls:24,vars:10,consts:[[3,"fullscreen"],["color","dark",1,"py-2"],[1,"ms-2","ms-md-5","mb-0","titulo"],[1,"palito","ms-2","ms-md-5","mt-0","mb-3"],[1,"container","px-5"],[3,"formGroup"],["shape","round",2,"max-width","400px",3,"click"],[1,"row"],["slot","end","style","max-height: 150px; width: 200px;",3,"src","click",4,"ngFor","ngForOf"],[1,"ion-margin-vertical"],["type","date",1,"form-control","my-3"],["type","text","label","Titulo","labelPlacement","floating","formControlName","titulo",1,"my-4","border"],[1,"NgxEditor__Wrapper"],[3,"toolbar","editor"],["formControlName","informacion",3,"editor","placeholder"],["expand","block","shape","round",1,"ion-margin-vertical",3,"disabled","click"],["slot","end",2,"max-height","150px","width","200px",3,"src","click"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-content",0),e._UZ(1,"br"),e.TgZ(2,"ion-toolbar",1),e._UZ(3,"br"),e.TgZ(4,"h1",2)(5,"b"),e._uU(6),e.qZA()(),e._UZ(7,"hr",3),e.qZA(),e.TgZ(8,"div",4)(9,"form",5)(10,"ion-button",6),e.NdJ("click",function(){return t.addImage()}),e._uU(11," Subir Fotograf\xedas "),e.qZA(),e.TgZ(12,"div",7),e.YNc(13,C,1,1,"ion-img",8),e.qZA(),e.TgZ(14,"ion-item",9)(15,"label"),e._uU(16,"Fecha de Boletin"),e.qZA(),e._UZ(17,"input",10),e.qZA(),e._UZ(18,"ion-input",11),e.TgZ(19,"div",12),e._UZ(20,"ngx-editor-menu",13)(21,"ngx-editor",14),e.qZA(),e.TgZ(22,"ion-button",15),e.NdJ("click",function(){return t.save()}),e._uU(23),e.qZA()()()()),2&i&&(e.Q6J("fullscreen",!0),e.xp6(6),e.hij(" ",t.editar?"Editar":"Crear"," Boletines"),e.xp6(3),e.Q6J("formGroup",t.sliderForm),e.xp6(4),e.Q6J("ngForOf",t.image),e.xp6(7),e.Q6J("toolbar",t.toolbar)("editor",t.editor),e.xp6(1),e.Q6J("editor",t.editor)("placeholder","Descripci\xf3n del evento"),e.xp6(1),e.Q6J("disabled",!t.image),e.xp6(1),e.hij(" ",t.editar?"Guardar Cambios":"Crear Bolet\xedn"," "))},dependencies:[v.sg,m._Y,m.JJ,m.JL,u.tP,u.Mn,m.sg,m.u,s.YG,s.W2,s.Xz,s.pK,s.Ie,s.sr,s.j9],styles:['@charset "UTF-8";ngx-editor[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto}  .NgxEditor{height:400px;overflow-y:scroll}  .NgxEditor__Content{min-height:400px}']}),l})()}];let J=(()=>{var o;class l{}return(o=l).\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.Bz.forChild(T),p.Bz]}),l})(),M=(()=>{var o;class l{}return(o=l).\u0275fac=function(i){return new(i||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[v.ez,m.u5,u.FP,m.UX,s.Pc,J]}),l})()}}]);