"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8602],{8602:(O,m,i)=>{i.r(m),i.d(m,{UserPageModule:()=>G});var d=i(6814),g=i(95),r=i(9843),p=i(7564),u=i(5861),f=i(7398),_=i(2181),x=i(9397),h=i(6528),U=i(553),n=i(6689),v=i(6533),P=i(930),y=i(2264),M=i(7153),Z=i(2425);function C(t,s){1&t&&(n.TgZ(0,"ion-spinner",6),n._uU(1," Cargando..."),n.qZA())}function T(t,s){1&t&&(n.TgZ(0,"ion-badge"),n._UZ(1,"ion-icon",17),n.qZA())}function J(t,s){if(1&t&&n._UZ(0,"img",18),2&t){const o=n.oxw(2);let e;n.Q6J("src",(o.user.gravatar?"":o.uri)+(null!==(e=o.user.foto)&&void 0!==e?e:"avatar.jpg"),n.LSH)}}function b(t,s){if(1&t&&n._UZ(0,"img",18),2&t){const o=n.oxw(2);let e;n.Q6J("src",null!==(e=o.image)&&void 0!==e?e:o.user.foto,n.LSH)}}function I(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"ion-item")(1,"ion-input",19),n.NdJ("ngModelChange",function(a){n.CHM(o);const c=n.oxw(2);return n.KtG(c.password=a)}),n.qZA()()}if(2&t){const o=n.oxw(2);n.xp6(1),n.Q6J("ngModel",o.password)}}function N(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"ion-item")(1,"ion-input",20),n.NdJ("ngModelChange",function(a){n.CHM(o);const c=n.oxw(2);return n.KtG(c.password2=a)}),n.qZA()()}if(2&t){const o=n.oxw(2);n.xp6(1),n.Q6J("ngModel",o.password2)}}function w(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"ion-button",14),n.NdJ("click",function(){n.CHM(o);const a=n.oxw(2);return n.KtG(a.update())}),n._uU(1," Guardar Cambios "),n._UZ(2,"ion-icon",21),n.qZA()}}const Y=function(t){return{"bg-gray":t}};function A(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"ion-card",7)(1,"ion-card-header")(2,"ion-card-subtitle",3)(3,"ion-avatar",8),n.NdJ("click",function(){n.CHM(o);const a=n.oxw();return n.KtG(a.edit?a.img():"")}),n.YNc(4,T,2,0,"ion-badge",9),n.YNc(5,J,1,1,"img",10),n.YNc(6,b,1,1,"img",10),n.qZA()(),n.TgZ(7,"ion-card-title",11)(8,"ion-item",12)(9,"ion-input",13),n.NdJ("ngModelChange",function(a){n.CHM(o);const c=n.oxw();return n.KtG(c.nombre=a)}),n.qZA()()()(),n.TgZ(10,"ion-card-content"),n.YNc(11,I,2,1,"ion-item",9),n.YNc(12,N,2,1,"ion-item",9),n.TgZ(13,"ion-button",14),n.NdJ("click",function(){n.CHM(o);const a=n.oxw();return n.KtG(a.edit=!a.edit)}),n._uU(14," Actualizar Perfil "),n._UZ(15,"ion-icon",15),n.qZA(),n.YNc(16,w,3,0,"ion-button",16),n.qZA()()}if(2&t){const o=n.oxw();n.xp6(4),n.Q6J("ngIf",o.edit),n.xp6(1),n.Q6J("ngIf",!o.edit),n.xp6(1),n.Q6J("ngIf",o.edit),n.xp6(3),n.Q6J("ngClass",n.VKq(9,Y,!o.edit))("readonly",!o.edit)("ngModel",o.nombre),n.xp6(2),n.Q6J("ngIf",o.edit),n.xp6(1),n.Q6J("ngIf",o.edit),n.xp6(4),n.Q6J("ngIf",o.edit)}}const Q=[{path:"",component:(()=>{var t;class s{constructor(e,a,c,l,H,K){this.authRepo=e,this.gService=a,this.compress=c,this.load=l,this.toast=H,this.modalC=K,this.uri=U.N.image+"users/",this.edit=!1}ngOnInit(){this.authRepo.user$.pipe((0,f.U)(e=>e[0]),(0,_.h)(e=>!!e),(0,x.b)(e=>{this.user=e,this.nombre=e.names})).subscribe()}img(){var e=this;return(0,u.Z)(function*(){e.image=yield e.compress.returnImageCompress();const a=yield e.modalC.create({component:h.n,animated:!0,componentProps:{imageUrl:e.image}});a.onDidDismiss().then(({data:c})=>{e.image=null!=c?c:null}),yield a.present()})()}update(){var e=this;return(0,u.Z)(function*(){if(e.password!==e.password2)return void e.toast.warning("Las contrase\xf1as no coindicen");yield e.load.setData({animated:!0,spinner:"dots",translucent:!0,message:"Actualizando..."}),yield e.load.create(),yield e.load.show();const a=new FormData;e.password&&a.append("password",e.password),e.nombre&&a.append("names",e.nombre),e.image&&a.append("foto",e.compress.dataURItoBlob(e.image)),e.gService.updateToken("user",a).subscribe(function(){var c=(0,u.Z)(function*(l){yield e.load.hide(),e.authRepo.updateUser(l.id,l),e.toast.success("Usuario actualizado"),e.edit=!1});return function(l){return c.apply(this,arguments)}}())})()}}return(t=s).\u0275fac=function(e){return new(e||t)(n.Y36(v.O),n.Y36(P.M),n.Y36(y.Y),n.Y36(M.b),n.Y36(Z._W),n.Y36(r.IN))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-user"]],decls:11,vars:3,consts:[[3,"fullscreen"],[1,"mt-5"],[1,"container","px-5"],[1,"d-flex"],["color","primary","class","mx-auto",4,"ngIf"],["class","shadow mx-auto","mode","ios",4,"ngIf"],["color","primary",1,"mx-auto"],["mode","ios",1,"shadow","mx-auto"],[1,"mx-auto","my-3",3,"click"],[4,"ngIf"],[3,"src",4,"ngIf"],[1,"text-center","mb-3"],["lines","none"],["type","text",1,"text-center",3,"ngClass","readonly","ngModel","ngModelChange"],["expand","block","shape","round",1,"my-2",3,"click"],["slot","icon-only","name","create-outline",1,"mx-2"],["class","my-2","expand","block","shape","round",3,"click",4,"ngIf"],["shape","round","name","add",1,"ms-auto"],[3,"src"],["type","password","label","Cambiar Contrase\xf1a","labelPlacement","floating",3,"ngModel","ngModelChange"],["type","password","label","Confirmar Contrase\xf1a","labelPlacement","floating",3,"ngModel","ngModelChange"],["slot","icon-only","name","save-outline",1,"mx-2"]],template:function(e,a){1&e&&(n.TgZ(0,"ion-content",0),n._UZ(1,"br")(2,"br")(3,"div",1),n.TgZ(4,"div",2)(5,"h1")(6,"b"),n._uU(7,"Mi Cuenta"),n.qZA()(),n.TgZ(8,"div",3),n.YNc(9,C,2,0,"ion-spinner",4),n.YNc(10,A,17,11,"ion-card",5),n.qZA()()()),2&e&&(n.Q6J("fullscreen",!0),n.xp6(9),n.Q6J("ngIf",!a.user),n.xp6(1),n.Q6J("ngIf",a.user))},dependencies:[d.mk,d.O5,g.JJ,g.On,r.BJ,r.yp,r.YG,r.PM,r.FN,r.Zi,r.tO,r.Dq,r.W2,r.gu,r.pK,r.Ie,r.PQ,r.j9],styles:["ion-avatar[_ngcontent-%COMP%]{width:150px;height:150px}.bg-gray[_ngcontent-%COMP%]{background-color:gray;color:#fff;text-align:center}"]}),s})()}];let F=(()=>{var t;class s{}return(t=s).\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[p.Bz.forChild(Q),p.Bz]}),s})(),G=(()=>{var t;class s{}return(t=s).\u0275fac=function(e){return new(e||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[d.ez,g.u5,r.Pc,F]}),s})()}}]);